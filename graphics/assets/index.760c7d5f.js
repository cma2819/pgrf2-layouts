import{b as t,d as e,r as s,p as a,a as n,F as o,h as r,e as i,f as c,c as u,u as d,t as l,j as m,T as p,w as y,g,o as h,D as f,k as v,l as w}from"./vendor.9cdb726b.js";const T={props:{opacity:{type:Number,default:1}},setup:s=>(a,n)=>(t(),e("div",{class:"box",style:{opacity:s.opacity}},null,4)),__scopeId:"data-v-e6d9ce8a"};const A={props:{animated:Boolean},setup(a){const n=s(10*Math.random()+5);return(s,a)=>(t(),e(T,{class:"animated",style:{animationDuration:`${n.value}s`}},null,8,["style"]))},__scopeId:"data-v-fefe2e50"};a("data-v-718e75f4");const b={id:"wrapper"},R=i("div",{id:"filter"},null,-1),I={key:0,id:"boxes"},S={key:1,id:"boxes"};n();const M={props:{animated:Boolean},setup(a){const n=s(60);return(s,i)=>(t(),e("div",b,[R,a.animated?(t(),e("div",I,[(t(!0),e(o,null,r([...Array(n.value)].map(((t,e)=>e)),(s=>(t(),e(A,{key:s})))),128))])):(t(),e("div",S,[(t(!0),e(o,null,r([...Array(n.value)].map(((t,e)=>e)),(s=>(t(),e(T,{key:s,opacity:Math.random()},null,8,["opacity"])))),128))]))]))},__scopeId:"data-v-718e75f4"};const x=y();a("data-v-24d3cb30");const j={key:0,id:"tweet-wrapper"},_={key:0,id:"tweet"},k=i("div",{id:"tweet-label",class:"label"},[g(" TWEET WITH "),i("span",null,"#PGRF2"),g(": ")],-1),D={class:"box"},F={id:"twitter-user"},$={id:"twitter-id"};n();const H={props:{width:{type:String,default:"420px"},small:{type:Boolean},from:{type:String,default:"left"}},setup(s){const a=c(),n=u((()=>a.getters.tweet));return(a,o)=>(t(),e(p,{name:`slide-from-${s.from}`},{default:x((()=>[d(n)?(t(),e("div",j,[d(n)?(t(),e("div",_,[k,i("div",D,[i("div",F,[i("img",{id:"twitter-icon",src:d(n).icon,alt:"icon"},null,8,["src"]),i("span",$,"@"+l(d(n).id),1)]),i("div",{id:"tweet-text",class:{small:s.small}},l(d(n).content),3)])])):m("",!0)])):m("",!0)])),_:1},8,["name"]))},__scopeId:"data-v-24d3cb30"},O={setup(t){const e=c();return h((()=>{const t=nodecg,s=nodecg;t.Replicant("runDataActiveRunSurrounding","nodecg-speedcontrol").on("change",(a=>{t.readReplicant("runDataArray","nodecg-speedcontrol",(t=>{const n=a.current,o=Math.max(t.findIndex((t=>t.id===n)),0);s.readReplicant("commentatorArray","speedcontrol-additions",(a=>{s.readReplicant("speedcontrolUserAdditionArray","speedcontrol-additions",(s=>{const n=t.slice(o,o+4).map((t=>{return{title:t.game||"",category:t.category||"",platform:t.system||"",startsAt:(e=new Date(t.scheduled),`${e.getFullYear()}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`),est:t.estimate||"",runners:t.teams.flatMap((t=>t.players.map((e=>{var a,n,o;const r=s.find((t=>t.id===e.customData.oengusId));return{id:t.id,name:e.name,accounts:{twitch:e.social.twitch,twitter:null==(a=null==r?void 0:r.social)?void 0:a.twitter,nico:null==(n=null==r?void 0:r.social)?void 0:n.nico,youtube:null==(o=null==r?void 0:r.social)?void 0:o.youtube}}})))),commentators:a.filter((e=>e.assignedRunIdArray.includes(t.externalID))).map((t=>({name:t.name,accounts:t.social})))};var e}));e.dispatch("setRuns",n)}))}))}))}));const a={stopped:"suspend",running:"running",paused:"suspend",finished:"complete"};t.Replicant("timer","nodecg-speedcontrol").on("change",(t=>{e.dispatch("setTimer",{time:t.time||"00:00",status:a[t.state||"paused"],split:(Object.entries(t.teamFinishTimes)||[]).map((([t,e])=>({id:t,time:e.time})))})}));nodecg.Replicant("spotifyPlayingTrack","nodecg-spotify-widget").on("change",(t=>{e.dispatch("setMusic",{title:(null==t?void 0:t.name)||"",artist:(null==t?void 0:t.artists.join(","))||""})}));nodecg.Replicant("activeTweet","nodecg-twitter-widget").on("change",(t=>{e.dispatch("setTweet",t&&{id:t.screenName,icon:t.profileImageUrl,content:t.text})}))})),()=>{}}};class E{constructor(t){this.title=t.title,this.category=t.category,this.platform=t.platform,this.startsAt=f.fromFormat(t.startsAt,"yyyy/MM/dd HH:mm:ss"),this.est=t.est,this.runners=t.runners,this.commentators=t.commentators}joinedRunnerNames(t=" / "){return this.runners.map((t=>t.name)).join(t)}joinedCommentatorNames(t=" / "){return this.commentators.map((t=>t.name)).join(t)}startsAtOnSchedule(){return this.startsAt.toFormat("HH:mm")}}class C{constructor(t){this.id=t.id,this.name=t.name,this.accounts=t.accounts,this.accountTypes=Object.keys(t.accounts)}currentAccount(){return{[this.accountTypes[0]]:this.accounts[this.accountTypes[0]]}}rotateAccountTypes(){this.accountTypes=this.accountTypes.slice(1).concat(this.accountTypes[0])}}var N=w({modules:{runs:{state:()=>({runs:[],currentRunners:[],currentCommentators:[]}),getters:{runsOnSchedule:({runs:t})=>t.slice(0,3).map((t=>new E(t))),currentEst:({runs:t})=>t[0].est,headerInfo:({runs:t})=>({title:t[0].title,category:t[0].category,platform:t[0].platform}),footerInfo:({runs:t})=>t.length>1?{title:t[1].title,category:t[1].category}:void 0},mutations:{setRuns(t,e){t.runs=e,t.currentRunners=e[0].runners.map((t=>new C(t))),t.currentCommentators=e[0].commentators.map((t=>new C(t)))},rotateAccounts({currentRunners:t,currentCommentators:e}){t.forEach((t=>{t.rotateAccountTypes()})),e.forEach((t=>{t.rotateAccountTypes()}))}},actions:{setRuns({commit:t},e){t("setRuns",e)},rotateAccounts({commit:t}){t("rotateAccounts")}}},timer:{state:()=>({time:"00:00:00",status:"suspend",splits:[]}),getters:{formattedTime:({time:t})=>{const e=t.split(":"),s=v.fromObject({hours:parseInt(e[0]),minutes:parseInt(e[1]),seconds:parseInt(e[2])});return s.hours>0?s.toFormat("hh:mm:ss"):s.toFormat("mm:ss")},splitOfId:({splits:t})=>e=>{const s=t.find((t=>e===t.id));return s?s.time:""}},mutations:{setTimer(t,e){t.time=e.time,t.status=e.status,t.splits=e.split}},actions:{setTimer({commit:t},e){t("setTimer",e)}}},tweet:{state:()=>({tweet:null}),getters:{tweet:({tweet:t})=>t},mutations:{setTweet(t,e){t.tweet=e}},actions:{setTweet({commit:t},e){t("setTweet",e)}}},spotify:{state:()=>({title:"",artist:""}),mutations:{setMusic(t,e){t.title=e.title,t.artist=e.artist}},actions:{setMusic({commit:t},e){t("setMusic",e)}}}}});export{O as _,M as a,H as b,N as s};
